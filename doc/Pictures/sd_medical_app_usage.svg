<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2464.8px" preserveAspectRatio="none" style="width:2336px;height:2464px;" version="1.1" viewBox="0 0 2336 2464" width="2336.4px" zoomAndPan="magnify"><defs><filter height="300%" id="f1uw5hjpk1wnko" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.4"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.8" dy="4.8" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="21.6" lengthAdjust="spacingAndGlyphs" textLength="181.2" x="1072.5" y="53.1164">Medical app usage</text><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="538.0125"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="610.8562"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="683.7"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1122.7406"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1195.5844"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1268.4281"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1341.2719"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="88.4438" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="2098.5094"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="1241.9438" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="929.4" y="471.1688"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="161.2875" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="929.4" y="2062.0875"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1411.8" y="938.2312"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1411.8" y="1011.075"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1411.8" y="1631.8687"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1989" y="1779.9563"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="16.8" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1989" y="1904.8219"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="68.8219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1989" y="2259.7969"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="240.5531" style="stroke: #000000; stroke-width: 2.4;" width="511.2" x="489.6" y="489.1688"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="310.575" style="stroke: #000000; stroke-width: 2.4;" width="705" x="858" y="746.5219"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="74.0438" style="stroke: #000000; stroke-width: 2.4;" width="363" x="870" y="828.9656"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="313.3969" style="stroke: #000000; stroke-width: 2.4;" width="511.2" x="489.6" y="1073.8969"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="273.7969" style="stroke: #000000; stroke-width: 2.4;" width="949.8" x="613.2" y="1404.0938"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="607.1062" style="stroke: #000000; stroke-width: 2.4;" width="1821" x="489.6" y="1731.1125"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="52.8" x2="52.8" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="309" x2="309" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="564" x2="564" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="934.8" x2="934.8" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1417.8" x2="1417.8" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1619.4" x2="1619.4" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1806" x2="1806" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1898.4" x2="1898.4" y1="167.7938" y2="2358.6188"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1994.4" x2="1994.4" y1="167.7938" y2="2358.6188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="80.4" x="9.6" y="164.1023">Participant</text><ellipse cx="53.4" cy="78.2625" fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 2.4;"/><path d="M53.4,87.8625 L53.4,120.2625 M37.8,97.4625 L69,97.4625 M53.4,120.2625 L37.8,138.2625 M53.4,120.2625 L69,138.2625 " fill="none" filter="url(#f1uw5hjpk1wnko)" style="stroke: #A80036; stroke-width: 2.4;"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="80.4" x="9.6" y="2374.8586">Participant</text><ellipse cx="53.4" cy="2390.55" fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" rx="9.6" ry="9.6" style="stroke: #A80036; stroke-width: 2.4;"/><path d="M53.4,2400.15 L53.4,2432.55 M37.8,2409.75 L69,2409.75 M53.4,2432.55 L37.8,2450.55 M53.4,2432.55 L69,2450.55 " fill="none" filter="url(#f1uw5hjpk1wnko)" style="stroke: #A80036; stroke-width: 2.4;"/><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="110.4" x="251.4" y="123.8625"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="259.8" y="149.7023">RaspberryPi</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="110.4" x="251.4" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="93.6" x="259.8" y="2383.2586">RaspberryPi</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="121.2" x="501.6" y="102.7313"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="104.4" x="510" y="128.5711">TELUS Shield</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="70.8" x="526.8" y="149.7023">with eSIM</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="121.2" x="501.6" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="104.4" x="510" y="2383.2586">TELUS Shield</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="70.8" x="526.8" y="2404.3898">with eSIM</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="102" x="882" y="123.8625"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="85.2" x="890.4" y="149.7023">Middleware</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="102" x="882" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="85.2" x="890.4" y="2383.2586">Middleware</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="261.6" x="1284.6" y="123.8625"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="244.8" x="1293" y="149.7023">CIRA IoT Registry DNS Resolver</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="261.6" x="1284.6" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="244.8" x="1293" y="2383.2586">CIRA IoT Registry DNS Resolver</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="109.2" x="1563" y="123.8625"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="92.4" x="1571.4" y="149.7023">Medical App</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="37.9313" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="109.2" x="1563" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="92.4" x="1571.4" y="2383.2586">Medical App</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="74.4" x="1766.4" y="102.7313"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="1774.8" y="128.5711">Medical</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="51.6" x="1777.8" y="149.7023">Device</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="74.4" x="1766.4" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="57.6" x="1774.8" y="2383.2586">Medical</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="51.6" x="1777.8" y="2404.3898">Device</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="76.8" x="1857.6" y="102.7313"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="1869.6" y="128.5711">TELUS</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="60" x="1866" y="149.7023">Network</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="76.8" x="1857.6" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="1869.6" y="2383.2586">TELUS</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="60" x="1866" y="2404.3898">Network</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="82.8" x="1951.2" y="102.7313"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="44.4" x="1970.4" y="128.5711">Cloud</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="66" x="1959.6" y="149.7023">Backend</text><rect fill="#FEFECE" filter="url(#f1uw5hjpk1wnko)" height="59.0625" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="82.8" x="1951.2" y="2357.4188"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="44.4" x="1970.4" y="2383.2586">Cloud</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="66" x="1959.6" y="2404.3898">Backend</text><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="538.0125"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="610.8562"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="683.7"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1122.7406"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1195.5844"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1268.4281"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="1341.2719"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="88.4438" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="558.6" y="2098.5094"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="1241.9438" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="929.4" y="471.1688"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="161.2875" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="929.4" y="2062.0875"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1411.8" y="938.2312"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1411.8" y="1011.075"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1411.8" y="1631.8687"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="36.4219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1989" y="1779.9563"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="16.8" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1989" y="1904.8219"/><rect fill="#FFFFFF" filter="url(#f1uw5hjpk1wnko)" height="68.8219" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="1989" y="2259.7969"/><polygon fill="#A80036" points="294.6,201.8156,306.6,206.6156,294.6,211.4156,299.4,206.6156" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="53.4" x2="301.8" y1="206.6156" y2="206.6156"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="123.6" x="61.8" y="200.7879">(1) RPi Power ON</text><polygon fill="#A80036" points="550.2,238.2375,562.2,243.0375,550.2,247.8375,555,243.0375" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="309" x2="557.4" y1="243.0375" y2="243.0375"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="141.6" x="317.4" y="237.2098">(2) Shield Power ON</text><polygon fill="#FBFB77" filter="url(#f1uw5hjpk1wnko)" points="274.8,258.6375,1838.4,258.6375,1850.4,273.0375,1838.4,287.4375,274.8,287.4375,262.8,273.0375,274.8,258.6375" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="451.2" x="831.3" y="279.6316">(3) RPi established connection over BT or USB to Medical Device</text><polygon fill="#A80036" points="294.6,315.8812,306.6,320.6813,294.6,325.4813,299.4,320.6813" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="53.4" x2="301.8" y1="320.6813" y2="320.6813"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="226.8" x="61.8" y="314.8535">(4.1) Connect to TELUS Network</text><polygon fill="#A80036" points="550.2,352.3031,562.2,357.1031,550.2,361.9031,555,357.1031" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="309" x2="557.4" y1="357.1031" y2="357.1031"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="226.8" x="317.4" y="351.2754">(4.2) Connect to TELUS Network</text><polygon fill="#FBFB77" filter="url(#f1uw5hjpk1wnko)" points="274.8,372.7031,1932,372.7031,1944,387.1031,1932,401.5031,274.8,401.5031,262.8,387.1031,274.8,372.7031" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="429.6" x="888.9" y="393.6973">(5) RPi established connection to TELUS Network(IP address)</text><polygon fill="#A80036" points="1605.6,429.9469,1617.6,434.7469,1605.6,439.5469,1610.4,434.7469" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="53.4" x2="1612.8" y1="434.7469" y2="434.7469"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="213.6" x="61.8" y="428.9191">(6) Execute (Run) Medical App</text><polygon fill="#A80036" points="954.6,466.3688,942.6,471.1688,954.6,475.9688,949.8,471.1688" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="947.4" x2="1618.8" y1="471.1688" y2="471.1688"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="508.8" x="961.8" y="465.341">(7) Get Connector Client CERT (client cert), ASP parent cert, FQDN, Port</text><path d="M489.6,489.1688 L733.2,489.1688 L733.2,498.7687 L721.2,510.7687 L489.6,510.7687 L489.6,489.1688 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="240.5531" style="stroke: #000000; stroke-width: 2.4;" width="511.2" x="489.6" y="489.1688"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="189.6" x="507.6" y="506.5629">(7.1) Get registry payload</text><polygon fill="#A80036" points="583.8,533.2125,571.8,538.0125,583.8,542.8125,579,538.0125" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="538.0125" y2="538.0125"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="270" x="591" y="532.1848">(7.1.1) Get CIRA Root CERT (root cert)</text><polygon fill="#A80036" points="915,569.6344,927,574.4344,915,579.2344,919.8,574.4344" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="574.4344" y2="574.4344"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="106.8" x="573" y="568.6066">(7.1.2) root cert</text><polygon fill="#A80036" points="583.8,606.0563,571.8,610.8562,583.8,615.6563,579,610.8562" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="610.8562" y2="610.8562"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="278.4" x="591" y="605.0285">(7.1.3) Get IoT Registry CERT (sub cert)</text><polygon fill="#A80036" points="915,642.4781,927,647.2781,915,652.0781,919.8,647.2781" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="647.2781" y2="647.2781"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="573" y="641.4504">(7.1.4) sub cert</text><polygon fill="#A80036" points="583.8,678.9,571.8,683.7,583.8,688.5,579,683.7" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="683.7" y2="683.7"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="147.6" x="591" y="677.8723">(7.1.5) Get client cert</text><polygon fill="#A80036" points="915,715.3219,927,720.1219,915,724.9219,919.8,720.1219" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="720.1219" y2="720.1219"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="117.6" x="573" y="714.2941">(7.1.6) client cert</text><path d="M858,746.5219 L1138.8,746.5219 L1138.8,756.1219 L1126.8,768.1219 L858,768.1219 L858,746.5219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="310.575" style="stroke: #000000; stroke-width: 2.4;" width="705" x="858" y="746.5219"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="226.8" x="876" y="763.916">(7.2) Validate registry payload</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="941.4" x2="991.8" y1="795.3656" y2="795.3656"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="991.8" x2="991.8" y1="795.3656" y2="810.9656"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="942.6" x2="991.8" y1="810.9656" y2="810.9656"/><polygon fill="#A80036" points="954.6,806.1656,942.6,810.9656,954.6,815.7656,949.8,810.9656" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="453.6" x="949.8" y="789.5379">(7.2.1) Prepare cert chain from payload (root &amp; sub &amp; client certs)</text><path d="M870,828.9656 L957.6,828.9656 L957.6,838.5656 L945.6,850.5656 L870,850.5656 L870,828.9656 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="74.0438" style="stroke: #000000; stroke-width: 2.4;" width="363" x="870" y="828.9656"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33.6" x="888" y="846.3598">loop</text><text fill="#000000" font-family="sans-serif" font-size="13.2" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="205.2" x="975.6" y="845.0684">[For each cert in the cert chain]</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="941.4" x2="991.8" y1="877.8094" y2="877.8094"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="991.8" x2="991.8" y1="877.8094" y2="893.4094"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="942.6" x2="991.8" y1="893.4094" y2="893.4094"/><polygon fill="#A80036" points="954.6,888.6094,942.6,893.4094,954.6,898.2094,949.8,893.4094" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="268.8" x="949.8" y="871.9816">(7.2.2) Validate cert &lt;i-1&gt; with cert &lt;i&gt;</text><polygon fill="#A80036" points="1397.4,933.4313,1409.4,938.2312,1397.4,943.0313,1402.2,938.2312" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="941.4" x2="1404.6" y1="938.2312" y2="938.2312"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="241.2" x="949.8" y="932.4035">(7.2.3) DNSSEC get root cert hash</text><polygon fill="#A80036" points="954.6,969.8531,942.6,974.6531,954.6,979.4531,949.8,974.6531" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="947.4" x2="1416.6" y1="974.6531" y2="974.6531"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="961.8" y="968.8254">(7.2.4) root cert hash</text><polygon fill="#A80036" points="1397.4,1006.275,1409.4,1011.075,1397.4,1015.875,1402.2,1011.075" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="941.4" x2="1404.6" y1="1011.075" y2="1011.075"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="252" x="949.8" y="1005.2473">(7.2.5) DNSSEC get client cert hash</text><polygon fill="#A80036" points="954.6,1042.6969,942.6,1047.4969,954.6,1052.2969,949.8,1047.4969" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="947.4" x2="1416.6" y1="1047.4969" y2="1047.4969"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="156" x="961.8" y="1041.6691">(7.2.6) client cert hash</text><path d="M489.6,1073.8969 L871.2,1073.8969 L871.2,1083.4969 L859.2,1095.4969 L489.6,1095.4969 L489.6,1073.8969 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="313.3969" style="stroke: #000000; stroke-width: 2.4;" width="511.2" x="489.6" y="1073.8969"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="327.6" x="507.6" y="1091.291">(7.3) Get asp portion of the registry payload</text><polygon fill="#A80036" points="583.8,1117.9406,571.8,1122.7406,583.8,1127.5406,579,1122.7406" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="1122.7406" y2="1122.7406"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="336" x="591" y="1116.9129">(7.3.1) Get Solace Root CERT (ASP parent cert)</text><polygon fill="#A80036" points="915,1154.3625,927,1159.1625,915,1163.9625,919.8,1159.1625" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="1159.1625" y2="1159.1625"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="160.8" x="573" y="1153.3348">(7.3.2) ASP parent cert</text><polygon fill="#A80036" points="583.8,1190.7844,571.8,1195.5844,583.8,1200.3844,579,1195.5844" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="1195.5844" y2="1195.5844"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="279.6" x="591" y="1189.7566">(7.3.3) Get ASP parent cert signed hash</text><polygon fill="#A80036" points="915,1227.2063,927,1232.0063,915,1236.8062,919.8,1232.0063" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="1232.0063" y2="1232.0063"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="249.6" x="573" y="1226.1785">(7.3.4) ASP parent cert signed hash</text><polygon fill="#A80036" points="583.8,1263.6281,571.8,1268.4281,583.8,1273.2281,579,1268.4281" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="1268.4281" y2="1268.4281"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="273.6" x="591" y="1262.6004">(7.3.5) Get ASP/Solace FQDN and port</text><polygon fill="#A80036" points="915,1300.05,927,1304.85,915,1309.65,919.8,1304.85" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="1304.85" y2="1304.85"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="153.6" x="573" y="1299.0223">(7.3.6) FQDN and port</text><polygon fill="#A80036" points="583.8,1336.4719,571.8,1341.2719,583.8,1346.0719,579,1341.2719" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="1341.2719" y2="1341.2719"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="272.4" x="591" y="1335.4441">(7.3.7) Get FQDN and port signed hash</text><polygon fill="#A80036" points="915,1372.8938,927,1377.6938,915,1382.4937,919.8,1377.6938" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="1377.6938" y2="1377.6938"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="242.4" x="573" y="1371.866">(7.3.8) FQDN and port signed hash</text><path d="M613.2,1404.0938 L1038,1404.0938 L1038,1413.6938 L1026,1425.6938 L613.2,1425.6938 L613.2,1404.0938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="273.7969" style="stroke: #000000; stroke-width: 2.4;" width="949.8" x="613.2" y="1404.0938"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="370.8" x="631.2" y="1421.4879">(7.4) Validate ASP portion of the registry payload</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="941.4" x2="991.8" y1="1452.9375" y2="1452.9375"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="991.8" x2="991.8" y1="1452.9375" y2="1468.5375"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="942.6" x2="991.8" y1="1468.5375" y2="1468.5375"/><polygon fill="#A80036" points="954.6,1463.7375,942.6,1468.5375,954.6,1473.3375,949.8,1468.5375" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="414" x="949.8" y="1447.1098">(7.4.1) Validate signed hash of FQDN and port with sub cert</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="941.4" x2="991.8" y1="1542.4031" y2="1542.4031"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="991.8" x2="991.8" y1="1542.4031" y2="1558.0031"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="942.6" x2="991.8" y1="1558.0031" y2="1558.0031"/><polygon fill="#A80036" points="954.6,1553.2031,942.6,1558.0031,954.6,1562.8031,949.8,1558.0031" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="373.2" x="949.8" y="1536.5754">(7.4.2) Validate signed hash of ASP cert with sub cert</text><path d="M625.2,1484.1375 L625.2,1593.3375 L918,1593.3375 L918,1496.1375 L906,1484.1375 L625.2,1484.1375 " fill="#FBFB77" filter="url(#f1uw5hjpk1wnko)" style="stroke: #A80036; stroke-width: 1.2;"/><path d="M906,1484.1375 L906,1496.1375 L918,1496.1375 L906,1484.1375 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="253.2" x="632.4" y="1506.3316">Because the ASP certificate is given</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="267.6" x="632.4" y="1525.9535">by an external CA, it cannot be verified</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="258" x="632.4" y="1545.5754">by the sub cert. We thus check if the</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="228" x="632.4" y="1565.1973">signature of the digest of the cert</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="217.2" x="632.4" y="1584.8191">(contained in the eSIM) is valid.</text><polygon fill="#A80036" points="1397.4,1627.0688,1409.4,1631.8687,1397.4,1636.6688,1402.2,1631.8687" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="941.4" x2="1404.6" y1="1631.8687" y2="1631.8687"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="274.8" x="949.8" y="1626.041">(7.4.3) DNSSEC get ASP TLSA Record</text><polygon fill="#A80036" points="954.6,1663.4906,942.6,1668.2906,954.6,1673.0906,949.8,1668.2906" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="947.4" x2="1416.6" y1="1668.2906" y2="1668.2906"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="141.6" x="961.8" y="1662.4629">(7.4.4) TLSA Record</text><polygon fill="#A80036" points="1605.6,1708.3125,1617.6,1713.1125,1605.6,1717.9125,1610.4,1713.1125" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="935.4" x2="1612.8" y1="1713.1125" y2="1713.1125"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="303.6" x="943.8" y="1707.2848">(8) client cert, ASP parent cert, FQDN, Port</text><path d="M489.6,1731.1125 L889.2,1731.1125 L889.2,1740.7125 L877.2,1752.7125 L489.6,1752.7125 L489.6,1731.1125 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="607.1062" style="stroke: #000000; stroke-width: 2.4;" width="1821" x="489.6" y="1731.1125"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="345.6" x="507.6" y="1748.5066">(9) Establish TLS Session with Cloud Backend</text><polygon fill="#A80036" points="1974.6,1775.1563,1986.6,1779.9563,1974.6,1784.7563,1979.4,1779.9563" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1620" x2="1981.8" y1="1779.9563" y2="1779.9563"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="1628.4" y="1774.1285">Client hello</text><polygon fill="#A80036" points="1633.2,1811.5781,1621.2,1816.3781,1633.2,1821.1781,1628.4,1816.3781" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1626" x2="1993.8" y1="1816.3781" y2="1816.3781"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="290.4" x="1640.4" y="1810.5504">Server hello with certificate and public key</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1620" x2="1670.4" y1="1852.8" y2="1852.8"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1670.4" x2="1670.4" y1="1852.8" y2="1868.4"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1621.2" x2="1670.4" y1="1868.4" y2="1868.4"/><polygon fill="#A80036" points="1633.2,1863.6,1621.2,1868.4,1633.2,1873.2,1628.4,1868.4" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="157.2" x="1628.4" y="1846.9723">Verify server certificate</text><polygon fill="#A80036" points="1974.6,1900.0219,1986.6,1904.8219,1974.6,1909.6219,1979.4,1904.8219" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1620" x2="1981.8" y1="1904.8219" y2="1904.8219"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="244.8" x="1628.4" y="1898.9941">Sends encrypted pre-master secret</text><polygon fill="#A80036" points="1633.2,1916.8219,1621.2,1921.6219,1633.2,1926.4219,1628.4,1921.6219" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1626" x2="1993.8" y1="1921.6219" y2="1921.6219"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1620" x2="1670.4" y1="1958.0437" y2="1958.0437"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1670.4" x2="1670.4" y1="1958.0437" y2="1973.6438"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1621.2" x2="1670.4" y1="1973.6438" y2="1973.6438"/><polygon fill="#A80036" points="1633.2,1968.8438,1621.2,1973.6438,1633.2,1978.4438,1628.4,1973.6438" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="169.2" x="1628.4" y="1952.216">Compute encryption key</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="1995" x2="2045.4" y1="2010.0656" y2="2010.0656"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="2045.4" x2="2045.4" y1="2010.0656" y2="2025.6656"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1996.2" x2="2045.4" y1="2025.6656" y2="2025.6656"/><polygon fill="#A80036" points="2008.2,2020.8656,1996.2,2025.6656,2008.2,2030.4656,2003.4,2025.6656" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="169.2" x="2003.4" y="2004.2379">Compute encryption key</text><polygon fill="#A80036" points="954.6,2057.2875,942.6,2062.0875,954.6,2066.8875,949.8,2062.0875" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="947.4" x2="1618.8" y1="2062.0875" y2="2062.0875"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="222" x="961.8" y="2056.2598">Request to sign TLS handshake</text><polygon fill="#A80036" points="583.8,2093.7094,571.8,2098.5094,583.8,2103.3094,579,2098.5094" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="576.6" x2="928.2" y1="2098.5094" y2="2098.5094"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="147.6" x="591" y="2092.6816">Request for signature</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="570.6" x2="621" y1="2134.9313" y2="2134.9313"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="621" x2="621" y1="2134.9313" y2="2150.5313"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="571.8" x2="621" y1="2150.5313" y2="2150.5313"/><polygon fill="#A80036" points="583.8,2145.7313,571.8,2150.5313,583.8,2155.3312,579,2150.5313" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="122.4" x="579" y="2129.1035">Perform signature</text><polygon fill="#A80036" points="915,2182.1531,927,2186.9531,915,2191.7531,919.8,2186.9531" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="564.6" x2="922.2" y1="2186.9531" y2="2186.9531"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="63.6" x="573" y="2181.1254">signature</text><polygon fill="#A80036" points="1605.6,2218.575,1617.6,2223.375,1605.6,2228.175,1610.4,2223.375" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="935.4" x2="1612.8" y1="2223.375" y2="2223.375"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="63.6" x="943.8" y="2217.5473">signature</text><polygon fill="#A80036" points="1974.6,2254.9969,1986.6,2259.7969,1974.6,2264.5969,1979.4,2259.7969" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="1620" x2="1981.8" y1="2259.7969" y2="2259.7969"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="234" x="1628.4" y="2253.9691">Send signature of TLS handshake</text><line style="stroke: #A80036; stroke-width: 1.2;" x1="2001" x2="2051.4" y1="2296.2188" y2="2296.2188"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="2051.4" x2="2051.4" y1="2296.2188" y2="2311.8188"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="2002.2" x2="2051.4" y1="2311.8188" y2="2311.8188"/><polygon fill="#A80036" points="2014.2,2307.0187,2002.2,2311.8188,2014.2,2316.6188,2009.4,2311.8188" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="286.8" x="2009.4" y="2290.391">Validate signature and authenticate client</text><polygon fill="#A80036" points="1633.2,2323.8188,1621.2,2328.6188,1633.2,2333.4188,1628.4,2328.6188" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 2.0,2.0;" x1="1626" x2="1993.8" y1="2328.6188" y2="2328.6188"/><text fill="#888888" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="118.8" x="2203.8" y="16.057">version 2020.10.01.2</text><!--MD5=[7827d4984a1a561fb14fa60a440fd0e0]
@startuml

header version 2020.10.01.2
title Medical app usage

actor Participant
participant RaspberryPi
participant "TELUS Shield\nwith eSIM"
participant Middleware
participant "CIRA IoT Registry DNS Resolver"
participant "Medical App"
participant "Medical\nDevice"
participant "TELUS\nNetwork"
participant "Cloud\nBackend"

Participant->RaspberryPi: (1) RPi Power ON
RaspberryPi->"TELUS Shield\nwith eSIM": (2) Shield Power ON

hnote over RaspberryPi,"Medical\nDevice": (3) RPi established connection over BT or USB to Medical Device

Participant->RaspberryPi: (4.1) Connect to TELUS Network
RaspberryPi->"TELUS Shield\nwith eSIM": (4.2) Connect to TELUS Network

hnote over RaspberryPi,"TELUS\nNetwork": (5) RPi established connection to TELUS Network(IP address)

Participant->"Medical App": (6) Execute (Run) Medical App

"Medical App"->Middleware ++: (7) Get Connector Client CERT (client cert), ASP parent cert, FQDN, Port

group (7.1) Get registry payload
    Middleware->"TELUS Shield\nwith eSIM" ++: (7.1.1) Get CIRA Root CERT (root cert)
    return (7.1.2) root cert
    Middleware->"TELUS Shield\nwith eSIM" ++: (7.1.3) Get IoT Registry CERT (sub cert)
    return (7.1.4) sub cert
    Middleware->"TELUS Shield\nwith eSIM" ++: (7.1.5) Get client cert
    return (7.1.6) client cert
end

group (7.2) Validate registry payload
    Middleware->Middleware: (7.2.1) Prepare cert chain from payload (root & sub & client certs)
    loop For each cert in the cert chain
        Middleware->Middleware: (7.2.2) Validate cert <i-1> with cert <i>
    end
    Middleware->"CIRA IoT Registry DNS Resolver" ++: (7.2.3) DNSSEC get root cert hash
    return (7.2.4) root cert hash
    Middleware->"CIRA IoT Registry DNS Resolver" ++: (7.2.5) DNSSEC get client cert hash
    return (7.2.6) client cert hash
end

group (7.3) Get asp portion of the registry payload
    Middleware->"TELUS Shield\nwith eSIM" ++: (7.3.1) Get Solace Root CERT (ASP parent cert)
    return (7.3.2) ASP parent cert
    Middleware->"TELUS Shield\nwith eSIM" ++: (7.3.3) Get ASP parent cert signed hash
    return (7.3.4) ASP parent cert signed hash
    Middleware->"TELUS Shield\nwith eSIM" ++: (7.3.5) Get ASP/Solace FQDN and port
    return (7.3.6) FQDN and port
    Middleware->"TELUS Shield\nwith eSIM" ++: (7.3.7) Get FQDN and port signed hash
    return (7.3.8) FQDN and port signed hash
end

group (7.4) Validate ASP portion of the registry payload
    Middleware->Middleware: (7.4.1) Validate signed hash of FQDN and port with sub cert
    Middleware->Middleware: (7.4.2) Validate signed hash of ASP cert with sub cert
    note left
            Because the ASP certificate is given
            by an external CA, it cannot be verified
            by the sub cert. We thus check if the
            signature of the digest of the cert
            (contained in the eSIM) is valid.
    end note
    Middleware->"CIRA IoT Registry DNS Resolver" ++: (7.4.3) DNSSEC get ASP TLSA Record
    return (7.4.4) TLSA Record
end

return (8) client cert, ASP parent cert, FQDN, Port

group (9) Establish TLS Session with Cloud Backend
    "Medical App" -> "Cloud\nBackend" ++: Client hello
    return Server hello with certificate and public key
    "Medical App" -> "Medical App": Verify server certificate
    "Medical App" -> "Cloud\nBackend" ++: Sends encrypted pre-master secret
    return
    "Medical App" -> "Medical App": Compute encryption key
    "Cloud\nBackend" -> "Cloud\nBackend": Compute encryption key
    "Medical App" -> Middleware ++: Request to sign TLS handshake
    Middleware -> "TELUS Shield\nwith eSIM" ++: Request for signature
    "TELUS Shield\nwith eSIM" -> "TELUS Shield\nwith eSIM": Perform signature
    return signature
    return signature
    "Medical App"->"Cloud\nBackend" ++: Send signature of TLS handshake
    "Cloud\nBackend"->"Cloud\nBackend": Validate signature and authenticate client
    return
end

@enduml

PlantUML version 1.2020.09(Sun May 10 06:51:06 EDT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.8+10-b944.31
Operating System: Windows 10
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>